<form [formGroup]="form" (ngSubmit)="onSubmit()" novalidate>
  <h2>Welcome on board!</h2>
  <p>We just need a little bit of data from you to get you started ðŸš€</p>

  <!-- Email -->
  <div class="control">
    <label for="email">Email</label>
    <input id="email" type="email" formControlName="email" autocomplete="email" aria-describedby="email-error" [attr.aria-invalid]="emailControl.invalid && emailControl.touched ? true : null" />
    @if (emailControl.invalid && emailControl.touched) {
      <div class="control-error" id="email-error" role="status" aria-live="polite">
        @if (emailControl.hasError('required')) {<p>Email is required.</p>}
        @if (emailControl.hasError('email')) {<p>Please enter a valid email address.</p>}
      </div>
    }
  </div>

  <!-- Passwords -->
  <div class="control-row" formGroupName="passwords">
    <div class="control">
      <label for="password">Password</label>
      <input id="password" type="password" formControlName="password" autocomplete="new-password" aria-describedby="password-error password-strength" [attr.aria-invalid]="passwordControl.invalid && passwordControl.touched ? true : null" />
      @if (passwordControl.invalid && passwordControl.touched) {
        <div class="control-error" id="password-error" role="status" aria-live="polite">
          @if (passwordControl.hasError('required')) {<p>Password is required.</p>}
          @if (passwordControl.hasError('minlength')) {<p>Password must be at least 6 characters.</p>}
        </div>
      }
      @if (passwordStrength !== 'empty') {
        <div class="password-strength" id="password-strength">
          <span [class.active]="passwordStrength === 'weak' || passwordStrength === 'medium' || passwordStrength === 'strong'" aria-hidden="true"></span>
          <span [class.active]="passwordStrength === 'medium' || passwordStrength === 'strong'" aria-hidden="true"></span>
          <span [class.active]="passwordStrength === 'strong'" aria-hidden="true"></span>
          <small class="password-strength-label">{{ passwordStrength | titlecase }} password</small>
        </div>
      }
    </div>

    <div class="control">
      <label for="confirm-password">Confirm Password</label>
      <input id="confirm-password" type="password" formControlName="confirmPassword" aria-describedby="confirm-error" [attr.aria-invalid]="(form.get('passwords')?.hasError('passwordsNotMatching') && confirmPasswordControl.touched) ? true : null" />
      @if (form.get('passwords')?.hasError('passwordsNotMatching') && confirmPasswordControl.touched) {
        <div class="control-error" id="confirm-error" role="status" aria-live="polite">
          <p>Passwords do not match.</p>
        </div>
      }
    </div>
  </div>

  <hr />

  <!-- First & Last Name -->
  <div class="control-row">
    <div class="control">
      <label for="first-name">First Name</label>
      <input id="first-name" type="text" formControlName="firstName" aria-describedby="first-name-error" [attr.aria-invalid]="form.get('firstName')?.invalid && form.get('firstName')?.touched ? true : null" />
      @if (form.get('firstName')?.invalid && form.get('firstName')?.touched) {
        <div class="control-error" id="first-name-error" role="status" aria-live="polite">
          <p>First name is required.</p>
        </div>
      }
    </div>

    <div class="control">
      <label for="last-name">Last Name</label>
      <input id="last-name" type="text" formControlName="lastName" aria-describedby="last-name-error" [attr.aria-invalid]="form.get('lastName')?.invalid && form.get('lastName')?.touched ? true : null" />
      @if (form.get('lastName')?.invalid && form.get('lastName')?.touched) {
        <div class="control-error" id="last-name-error" role="status" aria-live="polite">
          <p>Last name is required.</p>
        </div>
      }
    </div>
  </div>

  <fieldset formGroupName="address">
    <legend>Your Address</legend>
    <div class="control-row">
      <div class="control">
        <label for="street">Street</label>
        <input id="street" type="text" formControlName="street" />
      </div>
      <div class="control">
        <label for="number">Number</label>
        <input id="number" type="text" formControlName="location" />
      </div>
    </div>
    <div class="control-row">
      <div class="control">
        <label for="postal-code">Postal Code</label>
        <input id="postal-code" type="text" formControlName="pincode" />
      </div>
      <div class="control">
        <label for="city">City</label>
        <input id="city" type="text" formControlName="city" />
      </div>
    </div>
  </fieldset>

  <hr />

<!-- Role -->
<div class="control">
  <label for="role">What best describes your role?</label>
  <select id="role" formControlName="role" aria-describedby="role-error" [attr.aria-invalid]="form.get('role')?.touched && form.get('role')?.hasError('required') ? true : null">
    <option value="" disabled selected>Place select option</option>
    <option value="student">Student</option>
    <option value="teacher">Teacher</option>
    <option value="employee">Employee</option>
    <option value="founder">Founder</option>
    <option value="other">Other</option>
  </select>
  @if (form.get('role')?.touched && form.get('role')?.hasError('required')) {
    <div id="role-error" class="control-error" role="status" aria-live="polite">
      <p>Please select a valid role.</p>
    </div>
  }
</div>


  <!-- Acquisition -->
  <fieldset>
    <legend>How did you find us?</legend>
    <div *ngFor="let option of acquisitionOptions; let i = index" class="control">
      <input
        type="checkbox"
        [id]="option"
        [value]="option"
        (change)="onAcquisitionChange($event)"
      />
      <label [for]="option">{{ option | titlecase }}</label>
    </div>
  </fieldset>

  <!-- Terms -->
  <div class="control">
    <label>
      <input type="checkbox" formControlName="agree" />
      I agree to the terms and conditions
    </label>
    @if (form.get('agree')?.invalid && form.get('agree')?.touched) {
      <div class="control-error" role="status" aria-live="polite">
        <p>You must agree before submitting.</p>
      </div>
    }
  </div>

  <p class="form-actions">
    <button type="reset" class="button button-flat" (click)="onReset()">Reset</button>
    <button type="submit" class="button">Sign up</button>
  </p>

  @if (isSubmited) {
    <p class="control-success" role="status" aria-live="polite">Form has been submitted successfully!</p>
  }
</form>
